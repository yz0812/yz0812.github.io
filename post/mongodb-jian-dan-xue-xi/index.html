<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
<title>MongoDB 简单学习 - yz</title>
<meta name="description" content="少年拥有了时间,时间带走了年少。" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

<link type="text/css" rel="stylesheet" href="https://yz0812.github.io/styles/main.css" media="screen" />
<link type="text/css" rel="stylesheet" href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" />
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css" integrity="sha512-FwY1WVsm4UQgrOXt6kaQ53w83cOHa8fSvjFn/BvVOCYVPmkSR39k/xnU+8hht3zW6JL1TBd4C/aVQIAV58Cg6A==" crossorigin="anonymous" /> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/atom-one-dark.min.css" integrity="sha512-Jlyabam8ztU2kOGN19fSzv1Go9nt9A43UA6vhmL1MPsQMeoPZd+p7pbmegAtyl8kulna0Cqwb7Pgj4adGTLCXA==" crossorigin="anonymous" />
<script type="text/javascript" src="https://yz0812.github.io/media/scripts/jquery.js"></script>
<!-- <script type="text/javascript" src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js" integrity="sha512-tHQeqtcNWlZtEh8As/4MmZ5qpy0wj04svWFK7MIzLmUVIzaHXS8eod9OmHxyBL1UET5Rchvw7Ih4ZDv5JojZww==" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-7JNCPNX91Z"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'G-7JNCPNX91Z');
</script>


<script>
  hljs.initHighlightingOnLoad();
</script>

</head>

<body>
  <div class="layout">
    <div class="layout-header">

	<div class="layout-header-main">
		<div class="container">
			<div class="row justify-content-lg-center">
				<div class="col-12 col-lg-9">

					<div class="navbar">

						<div class="logo">
							<a href="https://yz0812.github.io">
								<img class="logo" src="https://yz0812.github.io/media/images/site_avatar.png?v=1759027540422"
									alt="">
							</a>
						</div>

						<div class="menu d-md-inline-block d-none">
							<ul class="layout-navigation-list">
								
								<li class="layout-navigation-item"><a title="归档"
										href="/archives">归档</a>
								</li>
								
								<li class="layout-navigation-item"><a title="标签"
										href="/tags">标签</a>
								</li>
								
								<li class="layout-navigation-item"><a title="关于"
										href="/post/about">关于</a>
								</li>
								
							</ul>
						</div>

						

						<div class="nav d-md-none d-inline-block">
							<div class="trigger">
								<i class="fa fa-bars layout-btn-toggle" aria-hidden="true"></i>
							</div>
						</div>

					</div>

				</div>
			</div>




		</div>
	</div>

</div>
    <div class="layout-collapse d-md-none">
	<div class="layout-collapse-main">
		<ul class="layout-collapse-list">
			
			<li class="layout-collapse-item"><a title="归档" href="/archives">归档</a></li>
			
			<li class="layout-collapse-item"><a title="标签" href="/tags">标签</a></li>
			
			<li class="layout-collapse-item"><a title="关于" href="/post/about">关于</a></li>
			

		</ul>
	</div>
</div>

    <div class="layout-content">
      <div class="layout-content-main">
        <div class="container">
          <div class="row justify-content-lg-center">
            <div class="col-12 col-lg-9">
              <div class="layout-post">
                <div class="layout-post-body">
                  <div class="row">

                    <div class="col-12 col-lg-10">
                      <div class="layout-post-main m-right m-md-right">
                        <div class="layout-post-header">
                          <h1 class="layout-post-title">MongoDB 简单学习</h1>
                          <div class="layout-post-meta">
                            <div class="item">
                               <a href="https://yz0812.github.io/tag/EXPhuDLUo/" class="post--keyword"
                                data-title="教程" data-type="post_tag" data-term-id="39">教程</a>
                              
                            </div>
                            <div class="item">
                              <span>2021-08-28</span>
                            </div>
                          </div>
                        </div>
                        <div class="layout-post-content">
                          <div class="layout-post-item">
                            
                            <p class="with-img"><img src="https://fastly.jsdelivr.net/gh/yz0812/mypic@master/img/47.jpg"
                                class="attachment-full size-full wp-post-image" alt="MongoDB 简单学习" /></p>
                            
                            <h4 id="mongodb-创建集合">mongodb 创建集合</h4>
<pre><code class="language-sql">db.createCollection(name, options)
</code></pre>
<p>参数说明：</p>
<ul>
<li>name: 要创建的集合名称</li>
<li>options: 可选参数, 指定有关内存大小及索引的选项</li>
</ul>
<p>options 可以是如下参数：</p>
<table>
<thead>
<tr>
<th style="text-align:left">字段</th>
<th style="text-align:right">类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">capped</td>
<td style="text-align:right">布尔</td>
<td style="text-align:left">（可选）如果为 true，则创建固定集合。固定集合是指有着固定大小的集合，当达到最大值时，它会自动覆盖最早的文档。 <strong>当该值为 true 时，必须指定 size 参数。</strong></td>
</tr>
<tr>
<td style="text-align:left">autoIndexId</td>
<td style="text-align:right">布尔</td>
<td style="text-align:left">3.2 之后不再支持该参数。（可选）如为 true，自动在 _id 字段创建索引。默认为 false。</td>
</tr>
<tr>
<td style="text-align:left">size</td>
<td style="text-align:right">数值</td>
<td style="text-align:left">（可选）为固定集合指定一个最大值，即字节数。 <strong>如果 capped 为 true，也需要指定该字段。</strong></td>
</tr>
<tr>
<td style="text-align:left">max</td>
<td style="text-align:right">数值</td>
<td style="text-align:left">（可选）指定固定集合中包含文档的最大数量。</td>
</tr>
</tbody>
</table>
<p>在插入文档时，MongoDB 首先检查固定集合的 size 字段，然后检查 max 字段。</p>
<pre><code class="language-sql">// 创建集合
db.createCollection(&quot;runoob&quot;)
// 创建固定集合 mycol，整个集合空间大小 6142800 B, 文档最大个数为 10000 个。
db.createCollection(&quot;mycol&quot;, { capped : true, autoIndexId : true, size : 
   6142800, max : 10000 } )
// 在 MongoDB 中，你不需要创建集合。当你插入一些文档时，MongoDB 会自动创建集合。
db.mycol2.insert({&quot;name&quot; : &quot;菜鸟教程&quot;})
</code></pre>
<p><strong>查看所有集合</strong></p>
<pre><code>// 如果要查看已有集合，可以使用 show collections 或 show tables 命令：
show collections

show tables 
</code></pre>
<h4 id="mongodb-删除集合">mongodb 删除集合</h4>
<p>MongoDB 中使用 drop() 方法来删除集合。</p>
<p><strong>语法格式：</strong></p>
<pre><code class="language-sql">db.collection.drop()
</code></pre>
<p>参数说明：</p>
<ul>
<li>无</li>
</ul>
<p><strong>返回值</strong></p>
<p>如果成功删除选定集合，则 drop() 方法返回 true，否则返回 false。</p>
<p><strong>实例</strong></p>
<pre><code class="language-sql">db.mycol.drop()
</code></pre>
<h4 id="mongodb-插入文档">mongodb 插入文档</h4>
<p>文档的数据结构和 JSON 基本一样。</p>
<p>所有存储在集合中的数据都是 BSON 格式。</p>
<p>BSON 是一种类似 JSON 的二进制形式的存储格式，是 Binary JSON 的简称。</p>
<p><strong>插入文档</strong></p>
<p>MongoDB 使用 insert() 或 save() 方法向集合中插入文档，语法如下：</p>
<pre><code>db.COLLECTION_NAME.insert(document)
或
db.COLLECTION_NAME.save(document)
</code></pre>
<ul>
<li>save()：如果 _id 主键存在则更新数据，如果不存在就插入数据。该方法新版本中已废弃，可以使用 <strong>db.collection.insertOne()</strong> 或 <strong>db.collection.replaceOne()</strong> 来代替。</li>
<li>insert(): 若插入的数据主键已经存在，则会抛 <strong>org.springframework.dao.DuplicateKeyException</strong> 异常，提示主键重复，不保存当前数据。</li>
</ul>
<p><strong>3.2 版本之后新增了 db.collection.insertOne() 和 db.collection.insertMany()。</strong></p>
<p>db.collection.insertOne() 用于向集合插入一个新文档，语法格式如下：</p>
<pre><code class="language-sql">db.collection.insertOne(
   &lt;document&gt;,
   {
      writeConcern: &lt;document&gt;
   }
)
</code></pre>
<p>db.collection.insertMany() 用于向集合插入一个多个文档，语法格式如下：</p>
<pre><code class="language-sql">db.collection.insertMany(
   [ &lt;document 1&gt; , &lt;document 2&gt;, ... ],
   {
      writeConcern: &lt;document&gt;,
      ordered: &lt;boolean&gt;
   }
)
</code></pre>
<p>参数说明：</p>
<ul>
<li>document：要写入的文档。</li>
<li>writeConcern：写入策略，默认为 1，即要求确认写操作，0 是不要求。</li>
<li>ordered：指定是否按顺序写入，默认 true，按顺序写入。</li>
</ul>
<p><strong>实例</strong></p>
<p>以下文档可以存储在 MongoDB 的 runoob 数据库 的 runoob 集合中：</p>
<pre><code class="language-sql">db.runoob.insert({title: 'MongoDB 教程', 
    description: 'MongoDB 是一个 Nosql 数据库',
    by: '菜鸟教程',
    url: 'http://www.runoob.com',
    tags: ['mongodb', 'database', 'NoSQL'],
    likes: 100
})
</code></pre>
<p><code>以上实例中 runoob 是我们的集合名，如果该集合不在该数据库中， MongoDB 会自动创建该集合并插入文档。</code></p>
<p>我们也可以将数据定义为一个变量，如下所示：</p>
<pre><code class="language-sql">document=({title: 'MongoDB 教程', 
    description: 'MongoDB 是一个 Nosql 数据库',
    by: '菜鸟教程',
    url: 'http://www.runoob.com',
    tags: ['mongodb', 'database', 'NoSQL'],
    likes: 100
});

db.runoob.insert(document)
</code></pre>
<h4 id="mongodb-修改文档">mongodb 修改文档</h4>
<p>MongoDB 使用 <strong>update()</strong> 和 <strong>save()</strong> 方法来更新集合中的文档。接下来让我们详细来看下两个函数的应用及其区别。</p>
<h5 id="update-方法">update() 方法</h5>
<p>update() 方法用于更新已存在的文档。语法格式如下：</p>
<pre><code class="language-sql">db.collection.update(
   &lt;query&gt;,
   &lt;update&gt;,
   {
     upsert: &lt;boolean&gt;,
     multi: &lt;boolean&gt;,
     writeConcern: &lt;document&gt;
   }
)
</code></pre>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong>query</strong> : update的查询条件，类似sql update查询内where后面的。</li>
<li><strong>update</strong> : update的对象和一些更新的操作符（如<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3em;vertical-align:-0.19444em;"></span><span class="mpunct">,</span></span></span></span>inc...）等，也可以理解为sql update查询内set后面的</li>
<li><strong>upsert</strong> : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。</li>
<li><strong>multi</strong> : 可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。</li>
<li><strong>writeConcern</strong> :可选，抛出异常的级别。</li>
</ul>
<p>我们通过 update() 方法来更新标题(title):</p>
<pre><code class="language-sql">db.col.update({'title':'MongoDB 教程'},{$set:{'title':'MongoDB'}})
</code></pre>
<p>可以看到标题(title)由原来的 &quot;MongoDB 教程&quot; 更新为了 &quot;MongoDB&quot;。</p>
<p>以上语句只会修改第一条发现的文档，如果你要修改多条相同的文档，则需要设置 multi 参数为 true。</p>
<pre><code class="language-sql">db.col.update({'title':'MongoDB 教程'},{$set:{'title':'MongoDB'}},{multi:true})
</code></pre>
<h5 id="save-方法">save() 方法</h5>
<p>save() 方法通过传入的文档来替换已有文档，_id 主键存在就更新，不存在就插入。语法格式如下：</p>
<pre><code class="language-sql">db.collection.save(
   &lt;document&gt;,
   {
     writeConcern: &lt;document&gt;
   }
)
</code></pre>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong>document</strong> : 文档数据。</li>
<li><strong>writeConcern</strong> :可选，抛出异常的级别。</li>
</ul>
<p>以下实例中我们替换了 _id 为 612a570f0af3be2fa4705e59 的文档数据：</p>
<pre><code class="language-sql">db.col.save({
    &quot;_id&quot; : ObjectId(&quot;612a570f0af3be2fa4705e59&quot;),
 title: 'MongoDB', 
    description: 'MongoDB 是一个 Nosql 数据库',
    by: '菜鸟教程',
    url: 'http://www.runoob.com',
    tags: ['mongodb', 'database', 'NoSQL'],
    likes: 100
})

</code></pre>
<h4 id="mongodb-删除文档">mongodb 删除文档</h4>
<p>remove() 方法的基本语法格式如下所示：</p>
<pre><code class="language-sql">db.collection.remove(
   &lt;query&gt;,
   &lt;justOne&gt;
)
// 如果你的 MongoDB 是 2.6 版本以后的，语法格式如下：
db.collection.remove(
   &lt;query&gt;,
   {
     justOne: &lt;boolean&gt;,
     writeConcern: &lt;document&gt;
   }
)
</code></pre>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong>query</strong> :（可选）删除的文档的条件。</li>
<li><strong>justOne</strong> : （可选）如果设为 true 或 1，则只删除一个文档，如果不设置该参数，或使用默认值 false，则删除所有匹配条件的文档。</li>
<li><strong>writeConcern</strong> :（可选）抛出异常的级别。</li>
</ul>
<p>接下来我们移除 title 为 'MongoDB 教程' 的文档：</p>
<pre><code class="language-sql">db.col.remove({'title':'MongoDB 教程'})
</code></pre>
<p>如果你想删除所有数据，可以使用以下方式（类似常规 SQL 的 truncate 命令）：</p>
<pre><code class="language-sql">db.col.remove({})
</code></pre>
<h4 id="mongodb-查询文档">mongodb 查询文档</h4>
<p>MongoDB 查询文档使用 find() 方法。</p>
<p>find() 方法以非结构化的方式来显示所有文档。</p>
<h5 id="语法">语法</h5>
<p>MongoDB 查询数据的语法格式如下：</p>
<pre><code class="language-sql">db.collection.find(query, projection)
</code></pre>
<ul>
<li><strong>query</strong> ：可选，使用查询操作符指定查询条件</li>
<li><strong>projection</strong> ：可选，使用投影操作符指定返回的键。查询时返回文档中所有键值， 只需省略该参数即可（默认省略）。</li>
</ul>
<p>如果你需要以易读的方式来读取数据，可以使用 pretty() 方法，语法格式如下：</p>
<pre><code class="language-sql">db.col.find().pretty()
</code></pre>
<h5 id="实例">实例</h5>
<p>以下实例我们查询了集合 col 中的数据：</p>
<pre><code class="language-sql">// 易读的方式来读取数据
db.col.find().pretty()
// 带条件查询
db.col.find({  &quot;_id&quot; : ObjectId(&quot;56063f17ade2f21f36b03133&quot;)})
// 查询一个
db.col.findOne()
</code></pre>
<h4 id="mongodb-条件操作符">mongodb 条件操作符</h4>
<p>条件操作符用于比较两个表达式并从mongoDB集合中获取数据。</p>
<p>在本章节中，我们将讨论如何在MongoDB中使用条件操作符。</p>
<p>MongoDB中条件操作符有：</p>
<ul>
<li>(&gt;) 大于 - $gt</li>
<li>(&lt;) 小于 - $lt</li>
<li>(&gt;=) 大于等于 - $gte</li>
<li>(&lt;= ) 小于等于 - $lte</li>
</ul>
<h5 id="mongodb-大于操作符-gt">MongoDB (&gt;) 大于操作符 - $gt</h5>
<pre><code class="language-sql">db.col.find({likes : {$gt : 100}})
// 类似于SQL语句：
Select * from col where likes &gt; 100;
</code></pre>
<h5 id="mongodb大于等于操作符-gte">MongoDB（&gt;=）大于等于操作符 - $gte</h5>
<pre><code class="language-sql">db.col.find({likes : {$gte : 100}})
// 类似于SQL语句：
Select * from col where likes &gt;=100;
</code></pre>

                          </div>
                        </div>
                        <div class="layout-post-social">
                          <div class="item reader">
                            <div id="/post/mongodb-jian-dan-xue-xi/" class="leancloud-visitors view"
                              data-flag-title="MongoDB 简单学习">
                              <span class="post-meta-item-text">阅读 </span>
                              <span class="leancloud-visitors-count"></span>
                            </div>
                          </div>
                        </div>

                        <div class="layout-post-navigation">
                          <div class="navigation-list">
                            
                            <div class="post-card row">
                              
                              <div class="card-content col-8 col-md-9">
                                <div class="card-body">
                                  <div class="header">
                                    <a href="https://yz0812.github.io/post/duo-xian-cheng/" class="title">
                                      <h4>多线程</h4>
                                    </a>
                                  </div>
                                  <div class="inner d-none d-sm-block">
                                    <div class="abstract">
                                      
                                    </div>
                                  </div>
                                </div>
                                <div class="card-footer">
                                  <div class="item"><span>上一篇</span></div>
                                  <div class="item">2021-09-05</div>
                                </div>
                              </div>
                              <div class="card-thumb col-4 col-md-3">
                                <div class="thumb">
                                  <a href="https://yz0812.github.io/post/duo-xian-cheng/"
                                    style="background-image: url('https://fastly.jsdelivr.net/gh/yz0812/mypic@master/img/51.jpg');"></a>
                                </div>
                              </div>
                              
                            </div>

                            <div class="post-card row">
                              
                              <div class="card-content col-8 col-md-9">
                                <div class="card-body">
                                  <div class="header">
                                    <a href="https://yz0812.github.io/post/gen-zhao-niao-ge-xue-spring-boot-20-webflux-zeng-shan-gai-cha-yang-li/" class="title">
                                      <h4>WebFlux增删改查样例</h4>
                                    </a>
                                  </div>
                                  <div class="inner d-none d-sm-block">
                                    <div class="abstract">
                                      
                                    </div>
                                  </div>
                                </div>
                                <div class="card-footer">
                                  <div class="item"><span>下一篇</span></div>
                                  <div class="item">2021-08-23</div>
                                </div>
                              </div>
                              <div class="card-thumb col-4 col-md-3">
                                <div class="thumb">
                                  <a href="https://yz0812.github.io/post/gen-zhao-niao-ge-xue-spring-boot-20-webflux-zeng-shan-gai-cha-yang-li/"
                                    style="background-image: url('https://fastly.jsdelivr.net/gh/yz0812/mypic@master/img/46.jpg');"></a>
                                </div>
                              </div>
                              
                            </div>

                            
                          </div>
                        </div>

                        <div class="layout-comments" id="comments">
                          
                            
                        </div>
                      </div>
                    </div>

                    <div class="col-12 col-lg-2 d-none d-lg-block">
                      <div class="layout-post-sidebar">
                        <div class="layout-sidebar-item">
                          <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#mongodb-%E5%88%9B%E5%BB%BA%E9%9B%86%E5%90%88">mongodb 创建集合</a></li>
<li><a href="#mongodb-%E5%88%A0%E9%99%A4%E9%9B%86%E5%90%88">mongodb 删除集合</a></li>
<li><a href="#mongodb-%E6%8F%92%E5%85%A5%E6%96%87%E6%A1%A3">mongodb 插入文档</a></li>
<li><a href="#mongodb-%E4%BF%AE%E6%94%B9%E6%96%87%E6%A1%A3">mongodb 修改文档</a>
<ul>
<li><a href="#update-%E6%96%B9%E6%B3%95">update() 方法</a></li>
<li><a href="#save-%E6%96%B9%E6%B3%95">save() 方法</a></li>
</ul>
</li>
<li><a href="#mongodb-%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3">mongodb 删除文档</a></li>
<li><a href="#mongodb-%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3">mongodb 查询文档</a>
<ul>
<li><a href="#%E8%AF%AD%E6%B3%95">语法</a></li>
<li><a href="#%E5%AE%9E%E4%BE%8B">实例</a></li>
</ul>
</li>
<li><a href="#mongodb-%E6%9D%A1%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%AC%A6">mongodb 条件操作符</a>
<ul>
<li><a href="#mongodb-%E5%A4%A7%E4%BA%8E%E6%93%8D%E4%BD%9C%E7%AC%A6-gt">MongoDB (&gt;) 大于操作符 - $gt</a></li>
<li><a href="#mongodb%E5%A4%A7%E4%BA%8E%E7%AD%89%E4%BA%8E%E6%93%8D%E4%BD%9C%E7%AC%A6-gte">MongoDB（&gt;=）大于等于操作符 - $gte</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="layout-totop d-none"><i class="fa fa-angle-up" aria-hidden="true"></i></div>

    	<div class="layout-footer">

		<div class="container">
			<div class="row justify-content-lg-center">
				<div class="col-12 col-lg-9">
					<div class="footer">
						<div class="row">
							<div class="col-12 col-md-9">
								<div class="footer-copy">
									
									<span>© 2018-05-01 </span>
									<a href="https://yz0812.github.io" title="yz">yz</a>
									<span class="px-2">⋅</span>
									
									
									<div class="footer-icp d-none d-sm-inline-block">
										<span class="px-2">⋅</span>
										
									</div>
								</div>
							</div>
							<div class="col-sm-3 d-none d-md-block">
								<div class="footer-links">
									
									
									
									
									
									
									
									
									
									
									
									
									
									
									
									
									
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>

	<script type="text/javascript" src='https://yz0812.github.io/media/scripts/main.js'></script>
	
	<script>
		var _hmt = _hmt || [];
		(function () {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?1bcfcef443c3da9720b8bc3f63856c73";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
		})();
	</script>
	

  </div>
</body>

</html>